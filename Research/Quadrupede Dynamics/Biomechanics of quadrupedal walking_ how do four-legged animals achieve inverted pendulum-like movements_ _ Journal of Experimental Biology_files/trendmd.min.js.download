!function t(e,r,n){function o(s,a){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=r[s]={exports:{}};e[s][0].call(c.exports,function(t){var r=e[s][1][t];return o(r||t)},c,c.exports,t,e,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,r){!function(t,r){void 0!==e?e.exports=r():"function"==typeof define&&"object"==typeof define.amd?define(r):this.domready=r()}(0,function(t){function e(t){for(u=1;t=n.shift();)t()}var r,n=[],o=document,i=o.documentElement,s=i.doScroll,a=s?/^loaded|^c/:/^loaded|c/,u=a.test(o.readyState);return o.addEventListener&&o.addEventListener("DOMContentLoaded",r=function(){o.removeEventListener("DOMContentLoaded",r,!1),e()},!1),s&&o.attachEvent("onreadystatechange",r=function(){/^c/.test(o.readyState)&&(o.detachEvent("onreadystatechange",r),e())}),t=s?function(e){self!=top?u?e():n.push(e):function(){try{i.doScroll("left")}catch(r){return setTimeout(function(){t(e)},50)}e()}()}:function(t){u?t():n.push(t)}})},{}],2:[function(t,e,r){function n(t){if(t)return o(t)}function o(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}e.exports=n,n.prototype.on=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},n.prototype.once=function(t,e){function r(){n.off(t,r),e.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},e._off=r,this.on(t,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks[t];if(!r)return this;if(1==arguments.length)return delete this._callbacks[t],this;var n=r.indexOf(e._off||e);return~n&&r.splice(n,1),this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks[t];if(r){r=r.slice(0);for(var n=0,o=r.length;n<o;++n)r[n].apply(this,e)}return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],3:[function(t,e,r){e.exports=function(t,e,r){for(var n=0,o=t.length,i=3==arguments.length?r:t[n++];n<o;)i=e.call(null,i,t[n],++n,t);return i}},{}],4:[function(t,e,r){function n(){}function o(t){switch({}.toString.call(t)){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function i(){if(b.XMLHttpRequest&&("file:"!=b.location.protocol||!b.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1}function s(t){return t===Object(t)}function a(t){if(!s(t))return t;var e=[];for(var r in t)null!=t[r]&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")}function u(t){for(var e,r,n={},o=t.split("&"),i=0,s=o.length;i<s;++i)r=o[i],e=r.split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]);return n}function c(t){var e,r,n,o,i=t.split(/\r?\n/),s={};i.pop();for(var a=0,u=i.length;a<u;++a)r=i[a],e=r.indexOf(":"),n=r.slice(0,e).toLowerCase(),o=g(r.slice(e+1)),s[n]=o;return s}function l(t){return t.split(/ *; */).shift()}function p(t){return m(t.split(/ *; */),function(t,e){var r=e.split(/ *= */),n=r.shift(),o=r.shift();return n&&o&&(t[n]=o),t},{})}function f(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text=this.xhr.responseText,this.setStatusProperties(this.xhr.status),this.header=this.headers=c(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text):null}function h(t,e){var r=this;y.call(this),this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var e=new f(r);"HEAD"==t&&(e.text=null),r.callback(null,e)})}function d(t,e){return"function"==typeof e?new h("GET",t).end(e):1==arguments.length?new h("GET",t):new h(t,e)}var y=t("emitter"),m=t("reduce"),b="undefined"==typeof window?this:window,g="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};d.serializeObject=a,d.parseString=u,d.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},d.serialize={"application/x-www-form-urlencoded":a,"application/json":JSON.stringify},d.parse={"application/x-www-form-urlencoded":u,"application/json":JSON.parse},f.prototype.get=function(t){return this.header[t.toLowerCase()]},f.prototype.setHeaderProperties=function(t){var e=this.header["content-type"]||"";this.type=l(e);var r=p(e);for(var n in r)this[n]=r[n]},f.prototype.parseBody=function(t){var e=d.parse[this.type];return e?e(t):null},f.prototype.setStatusProperties=function(t){var e=t/100|0;this.status=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=(4==e||5==e)&&this.toError(),this.accepted=202==t,this.noContent=204==t||1223==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},f.prototype.toError=function(){var t=this.req,e=t.method,r=t.path,n="cannot "+e+" "+r+" ("+this.status+")",o=new Error(n);return o.status=this.status,o.method=e,o.path=r,o},d.Response=f,y(h.prototype),h.prototype.timeout=function(t){return this._timeout=t,this},h.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},h.prototype.abort=function(){if(!this.aborted)return this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this},h.prototype.set=function(t,e){if(s(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},h.prototype.getHeader=function(t){return this._header[t.toLowerCase()]},h.prototype.type=function(t){return this.set("Content-Type",d.types[t]||t),this},h.prototype.accept=function(t){return this.set("Accept",d.types[t]||t),this},h.prototype.auth=function(t,e){var r=btoa(t+":"+e);return this.set("Authorization","Basic "+r),this},h.prototype.query=function(t){return"string"!=typeof t&&(t=a(t)),t&&this._query.push(t),this},h.prototype.send=function(t){var e=s(t),r=this.getHeader("Content-Type");if(e&&s(this._data))for(var n in t)this._data[n]=t[n];else"string"==typeof t?(r||this.type("form"),r=this.getHeader("Content-Type"),this._data="application/x-www-form-urlencoded"==r?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return e?(r||this.type("json"),this):this},h.prototype.callback=function(t,e){var r=this._callback;return 2==r.length?r(t,e):t?this.emit("error",t):void r(e)},h.prototype.crossDomainError=function(){var t=new Error("Origin is not allowed by Access-Control-Allow-Origin");t.crossDomain=!0,this.callback(t)},h.prototype.timeoutError=function(){var t=this._timeout,e=new Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},h.prototype.withCredentials=function(){return this._withCredentials=!0,this},h.prototype.end=function(t){var e=this,r=this.xhr=i(),s=this._query.join("&"),a=this._timeout,u=this._data;if(this._callback=t||n,r.onreadystatechange=function(){if(4==r.readyState)return 0==r.status?e.aborted?e.timeoutError():e.crossDomainError():void e.emit("end")},r.upload&&(r.upload.onprogress=function(t){t.percent=t.loaded/t.total*100,e.emit("progress",t)}),a&&!this._timer&&(this._timer=setTimeout(function(){e.abort()},a)),s&&(s=d.serializeObject(s),this.url+=~this.url.indexOf("?")?"&"+s:"?"+s),r.open(this.method,this.url,!0),this._withCredentials&&(r.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof u&&!o(u)){var c=d.serialize[this.getHeader("Content-Type")];c&&(u=c(u))}for(var l in this.header)null!=this.header[l]&&r.setRequestHeader(l,this.header[l]);return r.send(u),this},d.Request=h,d.get=function(t,e,r){var n=d("GET",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},d.head=function(t,e,r){var n=d("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.del=function(t,e){var r=d("DELETE",t);return e&&r.end(e),r},d.patch=function(t,e,r){var n=d("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.post=function(t,e,r){var n=d("POST",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.put=function(t,e,r){var n=d("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},e.exports=d},{emitter:2,reduce:3}],5:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(){function t(e){var r=this;n(this,t),this.candidates=e;var o=[{re:new RegExp(""+this.constructor.re.start+this.constructor.yearAndMonthName.parts.map(function(t){return r.constructor.re[t]}).join(this.constructor.re.separatorMonth)+this.constructor.re.end),year:this.constructor.yearAndMonthName.year,month:this.constructor.yearAndMonthName.month,name:!0}];this.patterns=o.concat(["yearAndMonth","monthDayYear","monthNameDayYear","monthYear","monthNameAndYear","year"].map(function(t){return r.constructor[t]}).map(function(t){return{re:new RegExp(""+r.constructor.re.start+t.parts.map(function(t){return r.constructor.re[t]}).join(r.constructor.re.separator)+r.constructor.re.end),year:t.year,month:t.month,name:t.name}})),this.extracted=this.constructor.compact(this.candidates.map(function(t){return r.extract(t)})),this.sorted=this.extracted.sort(function(t,e){return t[0]+"-"+(t[1]||99)<e[0]+"-"+(e[1]||99)?-1:1}),this.publicationDate=this.sorted[0]}return o(t,[{key:"extract",value:function(t){for(var e=["january","february","march","april","may","june","july","august","september","october","november","december"],r=0;r<this.patterns.length;r+=1){var n=this.patterns[r],o=t.match(n.re);if(o){var i=null;if(n.month&&(i=o[n.month],n.name))for(var s=i.toLowerCase(),a=0;a<e.length;a+=1){var u=e[a],c=u.match(s);c&&(i=String(e.indexOf(u)+1))}return this.constructor.compact([o[n.year],i])}}return null}}],[{key:"compact",value:function(t){return t.filter(function(t){return void 0!==t&&null!==t})}}]),t}();i.re={year:"(19\\d{2}|20\\d{2})",month:"(\\d{1,2})",monthName:"(\\w{3,9})",day:"\\d{1,2}",start:"(\\D|^)",end:"(\\D|$)",separator:"\\D+",separatorMonth:"\\W+"},i.yearAndMonth={parts:["year","month"],year:2,month:3},i.yearAndMonthName={parts:["year","monthName"],year:2,month:3,name:!0},i.monthDayYear={parts:["month","day","year"],year:3,month:2},i.monthNameDayYear={parts:["monthName","day","year"],year:3,month:2,name:!0},i.monthYear={parts:["month","year"],year:3,month:2},i.monthNameAndYear={parts:["monthName","year"],year:3,month:2,name:!0},i.year={parts:["year"],year:2},e.exports={DateParser:i}},{}],6:[function(t,e,r){"use strict";e.exports=function(t){return t.replace(/_([a-z])/g,function(t){return t[1].toUpperCase()})}},{}],7:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("./sources"),s=t("./DateParser"),a=s.DateParser,u=t("./camelCase"),c=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n(this,t),!e)throw new Error("document is required for new MetaExtractor instance");this.options=r,this.parse(e)}return o(t,[{key:"parse",value:function(t){var e=this,r=this.options.sources||this.constructor.defaultSources,n=this.options.meta_extractor_options,o=void 0===n?{prioritizeSelectors:void 0}:n,s=o.prioritizeSelectors;s&&(this.options.prioritizeSelectors=s,r=r.reduce(function(t,e){return"Selectors"===e?[e].concat(t):(t.push(e),t)},[])),this.sources=r.map(function(r){return new("string"==typeof r?i[r]:r)(t,e.options)}),[].slice.call(t.querySelectorAll("meta")).forEach(function(t){e.sources.forEach(function(e){e.add(t)})}),(this.options.tags||this.constructor.defaultTags).forEach(function(t){if("publication_date"===t){var r=new a(e.forCompact("publication_date")),n=r.publicationDate;n&&(e.publicationYear=n[0],e.publicationMonth=n[1])}else{var o="get"+e.constructor.ucCamelCase(t);e[u(t)]=e[o]?e[o]():e.firstFor(t)}})}},{key:"getDoi",value:function(){var t=this.firstFor("doi");if(t)return t.trim().replace("doi:","").replace("info:doi/","").replace("http://","").replace("https://","").replace("dx.doi.org/","").replace("doi.org/","").replace("doi","").replace("DOI","")}},{key:"getIssn",value:function(){var t=this.firstFor("issn");if(t)return t.replace("issn:","").replace("info:issn/","")}},{key:"getAuthors",value:function(){var t=this.constructor.uniq(this.forCompact("authors"));return t.length>1?t[0]+" et al.":t[0]}},{key:"getAbstract",value:function(){var t=this.options.prioritizeSelectors?0:7;return this.sources[t].get("abstract")||this.firstFor("abstract")}},{key:"firstFor",value:function(t){return this.forCompact(t)[0]}},{key:"forCompact",value:function(t){var e=[];return this.sources.map(function(e){return e.get(t)}).forEach(function(t){e=e.concat(t)}),this.constructor.compact(e)}},{key:"publication_year",get:function(){return this.publicationYear},set:function(t){this.publicationYear=t}},{key:"publication_month",get:function(){return this.publicationMonth},set:function(t){this.publicationMonth=t}},{key:"pubmed_id",get:function(){return this.pubmedId},set:function(t){this.pubmedId=t}},{key:"journal_title",get:function(){return this.journalTitle},set:function(t){this.journalTitle=t}},{key:"custom_id",get:function(){return this.customId},set:function(t){this.customId=t}}],[{key:"ucCamelCase",value:function(t){var e=u(t);return e.charAt(0).toUpperCase()+e.substr(1)}},{key:"compact",value:function(t){return t.filter(function(t){return void 0!==t&&null!==t})}},{key:"uniq",value:function(t){return t.filter(function(e,r){return t.indexOf(e)===r})}}]),t}();c.defaultSources=["HighWire","DublinCore","DCTerms","Prism","BEPress","EPrints","WolterKluwer","Selectors","OpenGraph"],c.defaultTags=["pubmed_id","doi","title","publication_date","authors","abstract"],e.exports={MetaExtractor:c,sources:i}},{"./DateParser":5,"./camelCase":6,"./sources":20}],8:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=t("./Source"),a=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),e}(s);a.prefix=["bepress","citation"],a.separator="_",e.exports=a},{"./Source":17}],9:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=t("./Source"),a=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),e}(s);a.defaultTags=["issn","journal_title","doi"],a.prefix="dcsext.wt",a.separator="_",a.issn="issn",a.journalTitle="name",a.doi="doi",e.exports=a},{"./Source":17}],10:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=t("./Source"),a=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),e}(s);a.defaultTags=["pubmed_id","doi","title","authors","abstract"],a.prefix="dcterms",a.authors="creator",a.abstract=["abstract","description"],a.journalTitle="publisher",a.issn="identifier.issn",e.exports=a},{"./Source":17}],11:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var s=o.get;if(void 0!==s)return s.call(n)},u=t("./Source"),c=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),s(e,[{key:"getIssn",value:function(){for(var t=this.forCompact("issn"),e=0;e<t.length;e+=1){var r=t[e];if(!this.constructor.checkDoi(r))return r}}},{key:"sortScore",value:function(t,r){var n=a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"sortScore",this).call(this,t,r);if("doi"===t||"issn"===t){n*=10;var o=r.getAttribute("scheme");o&&o.toLowerCase()===t&&(n-=5);var i=this.clean(r.getAttribute("content"));i&&0===i.toLowerCase().indexOf(t+":")&&(n-=1)}return n}}]),e}(u);c.prefix="dc",c.doi=["identifier.doi","identifier"],c.authors=["creator","contributor"],c.publicationDate=["date","issued"],c.abstract=["abstract","description"],c.journalTitle="publisher",c.issn=["identifier.issn","identifier"],e.exports=c},{"./Source":17}],12:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=t("./Source"),a=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),e}(s);a.prefix="eprints",a.authors="creators_name",a.journalTitle=["publication","publisher"],e.exports=a},{"./Source":17}],13:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=t("./Source"),a=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),e}(s);a.prefix="citation",a.separator="_",e.exports=a},{"./Source":17}],14:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var s=o.get;if(void 0!==s)return s.call(n)},u=t("./Source"),c=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),s(e,null,[{key:"nodeTag",value:function(t){var r=t.getAttribute("property");return r?r.toLowerCase():a(e.__proto__||Object.getPrototypeOf(e),"nodeTag",this).call(this,t)}}]),e}(u);c.prefix="og",c.separator=":",c.authors=[],c.publicationDate="article:published_time",c.abstract="description",e.exports=c},{"./Source":17}],15:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=t("./Source"),a=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),e}(s);a.prefix="prism",a.publicationDate="publicationdate",a.journalTitle="publicationname",a.issn=["eissn","issn"],e.exports=a},{"./Source":17}],16:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("./Source"),u=function(t){function e(t,r){n(this,e);var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.options.selectors=i.options.selectors||{},i.buckets={},i.tags.forEach(function(t){i.options.selectors[t]&&(i.buckets[t]=[].slice.call(i.document.querySelectorAll(i.options.selectors[t])).map(function(t){return"META"===t.tagName?t.content:t.textContent}))}),i}return i(e,t),s(e,[{key:"forCompact",value:function(t){return this.buckets[t]||[]}},{key:"add",value:function(){this.added=this.added}}]),e}(a);e.exports=u},{"./Source":17}],17:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("../camelCase"),s=function(){function t(e){var r=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,t),this.document=e,this.options=o,this.tags=this.options.tags||this.constructor.defaultTags,this.tagMap={},this.buckets={},this.tagOrder={},this.tags.forEach(function(t){r.buckets[t]=[],r.tagOrder[t]=[],[].concat(r.constructor[i(t)]).forEach(function(e){var n=r.constructor.tag(e);r.tagMap[n]=r.tagMap[n]||[],r.tagMap[n].push(t),r.tagOrder[t].push(n)})})}return o(t,[{key:"add",value:function(t){var e=this,r=this.constructor.nodeTag(t);(this.tagMap[r]||[]).forEach(function(r){t.getAttribute("content")&&e.buckets[r].push(t)})}},{key:"get",value:function(t){var e="get"+this.constructor.ucCamelCase(t);return"function"==typeof this[e]?this[e]():this.firstFor(t)}},{key:"getAuthors",value:function(){return this.forCompact("authors")}},{key:"getPublicationDate",value:function(){return this.forCompact("publication_date")}},{key:"getAbstract",value:function(){var t=this.forCompact("abstract");return t&&t.length?t.join(" ").trim():null}},{key:"getDoi",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"doi",e=this.forCompact(t),r=0;r<e.length;r+=1){var n=e[r];if(this.constructor.checkDoi(n))return n}}},{key:"firstFor",value:function(t){return this.forCompact(t)[0]}},{key:"forCompact",value:function(t){var e=this;return this.buckets[t]?this.buckets[t].sort(function(r,n){return e.sortScore(t,r)-e.sortScore(t,n)}).map(function(t){var r=t.getAttribute?t.getAttribute("content"):t;return e.clean(r)}):[]}},{key:"sortScore",value:function(t,e){return(this.tagOrder[t]||"").indexOf(this.constructor.nodeTag(e))}},{key:"clean",value:function(t){return this.htmlDecode(t).replace(/^\s+|\s+$/g,"").replace(/\s*[\n\t]+\s*/g," ")}},{key:"htmlDecode",value:function(t){var e=this.document.createElement("div");return e.innerHTML=t,0===e.childNodes.length?"":e.childNodes[0].textContent}}],[{key:"checkDoi",value:function(t){return t.match(/\//g)}},{key:"tag",value:function(t){return[].concat(this.prefix).concat(t).join(this.separator)}},{key:"nodeTag",value:function(t){var e=t.getAttribute("name");return e?e.toLowerCase():"invalid"}},{key:"ucCamelCase",value:function(t){var e=i(t);return e.charAt(0).toUpperCase()+e.substr(1)}}]),t}();s.prefix=[],s.separator=".",s.defaultTags=["pubmed_id","doi","title","authors","publication_date","abstract"],s.pubmedId=["pubmed_id","pmid"],s.doi="doi",s.title="title",s.authors=["authors","author"],s.publicationDate=["publication_date","date"],s.abstract="abstract",s.journalTitle=["journal_title","journal_abbrev"],s.issn="issn",e.exports=s},{"../camelCase":6}],18:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("./Source"),u=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),s(e,[{key:"getCustomId",value:function(){var t=this.document.querySelector('meta[name="pbContext"]');if(t&&t.content){var e=new RegExp("journal\\:journal\\:(\\w+?)(?:\\W|$)").exec(t.content);if(e&&e.length>1)return e[1]}return null}}]),e}(a);e.exports=u},{"./Source":17}],19:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=t("./Source"),a=function(t){function e(){return n(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),e}(s);a.prefix="wkhealth",a.separator="_",e.exports=a},{"./Source":17}],20:[function(t,e,r){"use strict";var n=t("./Source"),o=t("./HighWire"),i=t("./DublinCore"),s=t("./Prism"),a=t("./BEPress"),u=t("./EPrints"),c=t("./OpenGraph"),l=t("./WolterKluwer"),p=t("./DCTerms"),f=t("./Selectors"),h=t("./TandFonline"),d=t("./DCSext");e.exports={Source:n,HighWire:o,DublinCore:i,Prism:s,BEPress:a,EPrints:u,OpenGraph:c,WolterKluwer:l,DCTerms:p,Selectors:f,TandFonline:h,DCSext:d}},{"./BEPress":8,"./DCSext":9,"./DCTerms":10,"./DublinCore":11,"./EPrints":12,"./HighWire":13,"./OpenGraph":14,"./Prism":15,"./Selectors":16,"./Source":17,"./TandFonline":18,"./WolterKluwer":19}],21:[function(t,e,r){var n;n=function(){function t(t){var e,r,n,o,i,s,a;if(t){for(o=t.split(","),e=0,n=o.length;e<n;e++)s=o[e],-1!==s.indexOf("=")?(i=s.split("="),r=i[0],a=i[1],this[this.trim(r)]=this.trim(a)):this[this.trim(s)]=!0;this.abstract=parseInt(this.abstract)}}return t.prototype.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},t}(),e.exports={ArticleHeader:n}},{}],22:[function(t,e,r){var n,o,i;i=t("superagent"),o=t("trendmd-meta-extractor"),n=function(){function t(t,e){var r;this.api_url=t,this.options=e,this.options.journal_id?(this.endpoint="/journals/"+this.options.journal_id+"/selectors",this.params={}):(this.endpoint="/journals/identification",r=new o.MetaExtractor(window.document,{sources:["HighWire","DCSext","DublinCore","DCTerms","Prism","BEPress","EPrints","WolterKluwer","TandFonline"],tags:["doi","issn","journal_title","custom_id"]}),this.params={doi:r.doi,issn:r.issn,url:this.options.url||window.location.href,custom_id:this.options.custom_id||r.custom_id})}
return t.prototype.retrieve=function(t){return i.get(this.api_url+this.endpoint).set("TrendMD-Widget-Version",TrendMD.version).withCredentials().query(this.params).end(function(e){return function(e,r){if(!e&&!r.error)return t(r.body.journal)}}())},t}(),e.exports={JournalRetriever:n}},{superagent:4,"trendmd-meta-extractor":7}],23:[function(t,e,r){var n,o,i,s,a,u,c,l=[].slice,p=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1};i=t("domready"),i.domready=i,u=t("superagent"),a=t("trendmd-meta-extractor"),c=t("./tracker"),s=t("./journal-retriever"),o=t("./article-header"),n=function(){function t(t,e,r,n){this.api_url=t,this.tracker_url=e,this.stylesheet=r,this.options=n,i.domready(function(t){return function(){if(t.element=document.querySelector(t.options.element),t.element)return t.retrieve(function(e){return t.extractor=new a.MetaExtractor(document,e),t.show()})}}(this))}return t.MetaExtractor=a.MetaExtractor,t.Tracker=c.Tracker,t.prototype.retrieve=function(t){return this.retriever=new s.JournalRetriever(this.api_url,this.options),this.retriever.retrieve(function(e){return function(r){return e.journal=r,e.widget_endpoint="/journals/"+r.id+"/similar",e.missing_endpoint="/journals/"+r.id+"/missing",e.articles_endpoint="/journals/"+r.id+"/articles",t(r)}}(this))},t.prototype.show=function(){var t;return t=this.query_params(),this.is_missing(t)?this.missing():(this.addStyle(),this.article(t,function(t){return function(e,r){var n,i,s;if(!(e||r.error&&404!==r.status&&403!==r.status)){if(404===r.status)return t.create();if(n=new o.ArticleHeader(r.header["trendmd-article"]),n.id&&n.meta_dated&&(n.missing_meta||n.abstract<(null!=(s=t.extractor.abstract)?s.trim().length:void 0))&&t.update(n.id),403!==r.status)return i=r.text.replace(/Pending(\<span.*?),\s/gm,"$1"),t.element.innerHTML=i,n.id&&(t.tracker=new c.Tracker(t.tracker_url,t.journal.id,n.id,t.element),t.tracker.track()),t.gaTracking(),"function"==typeof t.options.cb?t.options.cb():void 0}}}(this)))},t.prototype.article=function(t,e){return u.get(this.api_url+this.widget_endpoint).set("TrendMD-Widget-Version",TrendMD.version).withCredentials().query(t).end(e)},t.prototype.missing=function(){if(!this.non_missing_url())return u.post(this.api_url+this.missing_endpoint).set("TrendMD-Widget-Version",TrendMD.version).send({url:this.options.url||window.location.href}).end()},t.prototype.create=function(t){return u.post(this.api_url+this.articles_endpoint).set("TrendMD-Widget-Version",TrendMD.version).send(this.store_params()).end(t)},t.prototype.update=function(t,e){return u.put(this.api_url+this.articles_endpoint+"/"+t).set("TrendMD-Widget-Version",TrendMD.version).send(this.store_params()).end(e)},t.prototype.query_params=function(){return this.params("pubmed_id","doi","title","authors","url","publication_year","publication_month")},t.prototype.store_params=function(){return this.params("pubmed_id","doi","title","authors","url","publication_year","publication_month","abstract")},t.prototype.params=function(){var t,e,r,n,o;for(n=1<=arguments.length?l.call(arguments,0):[],o={},p.call(n,"url")>=0&&(o.url=this.options.url||window.location.href),t=0,e=n.length;t<e;t++)"url"!==(r=n[t])&&(o[r]=this.checkParam(r,this.options[r]||this.extractor[r]));return o},t.prototype.checkParam=function(t,e){return"publication_year"===t?e>=1900&&e<=2100?e:null:"publication_month"===t?e>=1&&e<=12?e:null:e},t.prototype.is_missing=function(t){return this.missing_parameters(t)},t.prototype.missing_parameters=function(t){return!t.title&&!t.doi&&!t.pubmed_id},t.prototype.non_missing_url=function(){return this.file_url()||this.google_cache_url()},t.prototype.file_url=function(){return(this.options.url||window.location.href).match(/^file:\/\//)},t.prototype.google_cache_url=function(){return(this.options.url||window.location.href).match(/^http:\/\/webcache\.googleusercontent\.com\/search/)},t.prototype.addStyle=function(){var t;return t=document.createElement("link"),t.rel="stylesheet",t.type="text/css",t.href=this.stylesheet,t.media="all",document.getElementsByTagName("head")[0].appendChild(t)},t.prototype.gaTracking=function(){var t;return t=function(t,e,r,n,o,i,s){return t.GoogleAnalyticsObject=o,t[o]=t[o]||function(){return(t[o].q=t[o].q||[]).push(arguments)},t[o].l=1*new Date,i=e.createElement(r),s=e.getElementsByTagName(r)[0],i.async=1,i.src=n,s.parentNode.insertBefore(i,s)},t(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-47018061-3","auto",{allowLinker:!0,storage:"none",name:"tmdWidget"}),ga("tmdWidget.send","pageview",window.location.hostname+"/"+this.journal.id)},t}(),e.exports={SimilarWidget:n}},{"./article-header":21,"./journal-retriever":22,"./tracker":24,domready:1,superagent:4,"trendmd-meta-extractor":7}],24:[function(t,e,r){var n,o;o=t("superagent"),n=function(){function t(t,e,r,n){var o;this.collector_url=t,this.journal_id=e,this.article_id=r,this.element=n,o=this.element.addEventListener?["addEventListener","click"]:["attachEvent","onclick"],this.listen_method=o[0],this.listen_event=o[1]}return t.prototype.events_endpoint="/events",t.prototype.attributes={article_id:"data-trendmd-id",journal_id:"data-trendmd-journal-id",sponsored:"data-trendmd-sponsored",campaign_id:"data-trendmd-campaign-id"},t.prototype.selectors={organic:'a[data-trendmd-sponsored="false"]',sponsored:'a[data-trendmd-sponsored="true"]'},t.prototype.track=function(){return this.trackImpressions(),this.trackRecommendations()},t.prototype.trackImpressions=function(){var t;return this.log({"organic-impressions":function(){var e,r,n,o;for(n=this.nodes("organic"),o=[],e=0,r=n.length;e<r;e++)t=n[e],o.push(this.params(t));return o}.call(this),"sponsored-impressions":function(){var e,r,n,o;for(n=this.nodes("sponsored"),o=[],e=0,r=n.length;e<r;e++)t=n[e],o.push(this.params(t));return o}.call(this)})},t.prototype.trackRecommendations=function(){var t,e,r,n;e=this.selectors,r=[];for(n in e)e[n],"all"!==n&&r.push(function(){var e,r,o,i;for(o=this.nodes(n),i=[],e=0,r=o.length;e<r;e++)t=o[e],i.push(this.addClickLogger(t,n));return i}.call(this));return r},t.prototype.addClickLogger=function(t,e){return t[this.listen_method](this.listen_event,function(r){return function(){var n;return r.log((n={},n[e+"-recommendations"]=[r.params(t)],n))}}(this))},t.prototype.nodes=function(t){return this.element.querySelectorAll(this.selectors[t])},t.prototype.params=function(t){return{from_journal_id:this.journal_id,from_article_id:this.article_id,to_journal_id:t.getAttribute(this.attributes.journal_id),to_article_id:t.getAttribute(this.attributes.article_id),campaign_id:t.getAttribute(this.attributes.campaign_id)}},t.prototype.log=function(t){return o.post(this.collector_url+this.events_endpoint).set("TrendMD-Widget-Version",TrendMD.version).withCredentials().send({events:t}).end()},t}(),e.exports={Tracker:n}},{superagent:4}],25:[function(t,e,r){(function(r){var n,o,i,s,a,u;a=t("./similar-widget"),o=function(t){return decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null},s=function(){return window.parent.postMessage({sentinel:"amp",type:"embed-size",height:document.body.scrollHeight},"*")},u=function(){var t,e,r;for(t=document.getElementsByClassName("trendmd-widget-list-item__link"),e=0,r=[];e<t.length;)t[e].setAttribute("target","_blank"),r.push(e++);return r},i=function(){var t,e,r;return e=document.currentScript||function(){var t,r,n,o;for(o=document.getElementsByTagName("script"),n="",t=0,r=o.length;t<r;t++)e=o[t],e.getAttribute("data-trendmdconfig")&&(n=e);return n}(),e&&(t=e.getAttribute("data-amp")),t?(r={},r.title=o("title"),r.doi=o("doi"),r.journal_id=o("journalId"),r.issn=o("issn"),r.pubmed_id=o("pubmed"),r.url=o("url"),r.custom=o("custom"),r.element="#trendmd-suggestions",r.cb=function(){return s(),u()},r):(e&&(r=e.getAttribute("data-trendmdconfig")),r&&(r=r.replace(/\'/g,'"')),r?JSON.parse(r):void 0)}(),n=function(){function t(){}return t.SimilarWidget=a.SimilarWidget,t.prototype.api_url="//www.trendmd.com",t.prototype.tracker_url="//academia.trendmd.com",t.prototype.widget_stylesheet="//trendmd.s3.amazonaws.com/trendmd.min.css",t.prototype.version="290917",t.prototype.register=function(t){if(!1!==((null!=i?i.widget:void 0)||(null!=t?t.widget:void 0)))return this.register_widget(i||t)},t.prototype.register_widget=function(t){return this.widget=new a.SimilarWidget(this.api_url,this.tracker_url,this.widget_stylesheet,t)},t}(),e.exports=n,r.TrendMD=new n,i&&(new n).register()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./similar-widget":23}]},{},[25]);